'<<--BEGIN_CODE_SEGMENT_PRINTHEADER-->>
Dim wrkMth, sqlw, rstw

wrkMth = ""
wrkMth = Trim(Request.QueryString(("wrkMth")))
selectPrd = Trim(Request.QueryString(("selectPrd")))
selectPrd1 = Trim(Request.QueryString(("selectPrd1")))
selectPrddn = Trim(Request.QueryString(("selectPrddn")))
'reqPatID = Trim(Request.QueryString("PatientID"))
response.Clear

response.write "<!DOCTYPE html>"
response.write "<html>"
response.write "  <head>"
response.write "     <title>Patient Information</title>"
StylesAdded
response.write "  </head>"
response.write "  <body>"
If (wrkMth <> "") And (wrkMth <> "AllMonths") Then
    sqlw = " Select PatientID, PatientName, BirthDate, CountryID, GenderID, ResidencePhone FROM Patient "
    sqlw = sqlw & " WHERE FirstMonthID = '" & wrkMth & "' Order By FirstVisitDate Desc;"
    
    DisplayReport sqlw
ElseIf (wrkMth = "AllMonths") Then
    sqlw = " Select PatientID, PatientName, BirthDate, CountryID, GenderID, ResidencePhone FROM Patient "
    sqlw = sqlw & " Order By FirstVisitDate Desc;"
    
    DisplayReport sqlw
ElseIf (selectPrddn = "Period") Then
    sqlw = " Select PatientID, PatientName, BirthDate, CountryID, GenderID, ResidencePhone FROM Patient "
    sqlw = sqlw & " WHERE FirstVisitDate BETWEEN '" & selectPrd & "' AND '" & selectPrd1 & "' Order By FirstVisitDate Desc;"
    
    DisplayReport sqlw
Else
    sqlw = " Select top 500 PatientID, PatientName, BirthDate, CountryID, GenderID, ResidencePhone FROM Patient "
    sqlw = sqlw & " Order By FirstVisitDate Desc;"
    
    DisplayReport sqlw
    
    If (wrkMth <> "") And (wrkMth <> "AllMonths") Then
        sqlw = " Select PatientID, PatientName, BirthDate, CountryID, GenderID, ResidencePhone FROM Patient "
        sqlw = sqlw & " WHERE FirstMonthID = '" & wrkMth & "' Order By FirstVisitDate Desc;"
End If
TableEXScp
response.write "    <script src='https://kit.fontawesome.com/91bd23ceba.js'></script>"
response.write "  </body>"
response.write "</html>"

Sub DisplayReport(sql)
    Dim rst
    Set rst = CreateObject("ADODB.Recordset")
    rst.open qryPro.FltQry(sql), conn, 3, 4

    TopHead
    If rst.RecordCount > 0 Then
        rst.movefirst
        response.write "      <div class='cnt-body p15 m25 mt0'>"
        response.write "        <div class='p15 df dnp pt0'>"
        response.write "          <button id='exportCSV' class='btsty bs'>"
        response.write "            <span>Export to CSV &nbsp;</span>"
        response.write "            <i class='fa-solid fa-file-csv'></i>"
        response.write "          </button>"
        response.write "          <button id='exportExcel' class='btsty bs'>"
        response.write "            <span>Export to Excel &nbsp;</span>"
        response.write "            <i class='fa-solid fa-file-excel'></i>"
        response.write "          </button>"
        response.write "          <button id='printButton' class='btsty bs'>"
        response.write "            <span>Print Table &nbsp;</span>"
        response.write "            <i class='fa-solid fa-print'></i>"
        response.write "          </button>"
        response.write "        </div>"
        response.write "        <div class='tab-table tbl-main mil'>"
        response.write "          <div class='table-holder'>"
        response.write "            <table class='tbl'>"
        response.write "              <thead class='tbl-h'>"
        response.write "                <tr>"
        response.write "                  <th data-sort='none' class='fh t-left'>No.</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Patient No</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Full Name</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Date of Birth</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Nationality</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Gender</th>"
        response.write "                  <th data-sort='none' class='fh t-left'>Contact</th>"
        response.write "                  <th data-sort='none' class='fh t-left'></th>"
        response.write "                </tr>"
        response.write "              </thead>"
        response.write "              <tbody class='tbl-b'>"
        Do While Not rst.EOF
            pos = rst.AbsolutePosition
            pat = rst.fields("PatientID")
            pname = rst.fields("PatientName")
            response.write "                <tr>"
            response.write "                  <td>" & pos & "</td>"
            response.write "                  <td>" & pat & "</td>"
            response.write "                  <td>" & pname & "</td>"
            response.write "                  <td>" & FormatDate(rst.fields("BirthDate")) & "</td>"
            response.write "                  <td>" & GetComboName("Country", rst.fields("CountryID")) & "</td>"
            response.write "                  <td>" & GetComboName("Gender", rst.fields("GenderID")) & "</td>"
            response.write "                  <td>" & rst.fields("ResidencePhone") & "</td>"
            CardVal pat
            Printcard pat
            response.write "                </tr>"
            rst.movenext
            response.Flush
        Loop
        response.write "              </tbody>"
        response.write "            </table>"
        response.write "          </div>"
        response.write "        </div>"
        response.write "      </div>"
        ScpAdded
        rst.Close
        Set rst = Nothing
    Else
        response.write "      <div class='cnt-body p15 m25 mt0'>"
        response.write "        <div class='df f1 plr25 mlr25'>"
        response.write "          <div class='t2 plr10'>No Record Available</div>"
        response.write "        </div>"
        response.write "      </div>"
    End If

End Sub

Sub TopHead()

    response.write "  <div class='t-case rlt t-title'>"
    response.write "    <div class='abs min-top df jc cp'>"
    response.write "      <div class='rlt'><div class='abs t-case-i'>Minimize</div></div>"
    response.write "      <i class='fa-solid fa-angle-up icnn'></i>"
    response.write "    </div>"
    response.write "    <div class='cnt m15'>"
    response.write "      <div class='t-title df fs p15 pb0 dnp'>"
    response.write periodSelector("workingMonthID", "workingMonth", "workingYearID", "workingYear", "Receipt")
    response.write "        <div class='df f1'>"
    response.write "          <div class='t2 plr10'>Find Patient</div>"
    response.write "          <input class='select-value1' type='text' id='searchInput' placeholder='search..'/>"
    response.write "        </div>"
    response.write "      </div>"
    response.write "      <div class='t-title df fs p15 pb0 dnp'>"
    response.write pSelector(selectPrd, selectPrd)
    response.write "      </div>"
    If (selectPrddn = "Period") Then
        response.write "      <div class='t-title df fs p15 pb0 dnp'>"
        response.write "       <div class='period-selector df'> "
        response.write "           <span class='t2 plr15'>Receipts From</span>"
        response.write "           <span class='st2 plr15'>" & selectPrd & "</span>"
        response.write "           <span class='t2 plr15'>To</span>"
        response.write "           <span class='st2 plr15'>" & selectPrd1 & "</span>"
        response.write "       </div>"
        response.write "      </div>"
    End If
    response.write "    </div>"
    response.write "  </div>"

End Sub

Function pSelector(selectPrd, selectPrd1)
   Dim rst, sql
   html = " "

   dt = SplitDateTime(selectPrd)
   dt1 = SplitDateTime(selectPrd1)
    
    selectPrda = dt(0)
    selectPrdb = dt(1)
    selectPrd1a = dt1(0)
    selectPrd1b = dt1(1)

   html = html & " <div class='period-selector df'> "
   html = html & "     <span class='t2 pl10 wn'>Select Period</span>"
   html = html & "     <span class='t2 plr15'>From</span>"
   If (selectPrd <> "") Then
      html = html & "     <input class='select-value1' name='selectPrd' id='selectPrd' type='date' pattern='\d{2}/\d{2}/\d{4}' value='" & selectPrda & "'/>"
      html = html & "     <input class='select-value1' name='selectPrda' id='selectPrda' type='time' step='60' value='" & selectPrdb & "'/>"
   Else
      html = html & "     <input class='select-value1' name='selectPrd' id='selectPrd' type='date' pattern='\d{2}/\d{2}/\d{4}' value=''/>"
      html = html & "     <input class='select-value1' name='selectPrd' id='selectPrda' type='time' step='60' value='00:00:00.000'/>"
   End If
   html = html & "     <span class='t2 plr15'>To</span>"
   If (selectPrd1 <> "") Then
      html = html & "     <input class='select-value1' name='selectPrd1' id='selectPrd1' type='date' pattern='\d{2}/\d{2}/\d{4}' value='" & selectPrd1a & "' />"
      html = html & "     <input class='select-value1' name='selectPrd1a' id='selectPrd1a' type='time' step='60' value='" & selectPrd1b & "' />"
   Else
      html = html & "     <input class='select-value1' name='selectPrd' id='selectPrd1' type='date' pattern='\d{2}/\d{2}/\d{4}' value='' />"
      html = html & "     <input class='select-value1' name='selectPrd' id='selectPrd1a' type='time' step='60' value='23:59:00.000' />"
   End If
   html = html & "     <div class='btsty bs' onclick='perdschange()'>Submit</div>"
   html = html & " <script>" & vbCrLf
   html = html & "  function getTimeWithSecondsAndMilliseconds(inputTime) {" & vbCrLf
   html = html & "     const [hours, minutes] = inputTime.split(':');" & vbCrLf
   html = html & "     const currentTime = new Date();" & vbCrLf
   html = html & "     currentTime.setHours(hours);" & vbCrLf
   html = html & "     currentTime.setMinutes(minutes);" & vbCrLf
   html = html & "     currentTime.setSeconds(0);" & vbCrLf
   html = html & "     currentTime.setMilliseconds(0);" & vbCrLf
   html = html & "     const formattedSeconds = String(currentTime.getSeconds()).padStart(2, '0');" & vbCrLf
   html = html & "     const formattedMilliseconds = String(currentTime.getMilliseconds()).padStart(3, '0');" & vbCrLf
   html = html & "     return `${hours}:${minutes}:${formattedSeconds}.${formattedMilliseconds}`;" & vbCrLf
   html = html & "  }" & vbCrLf
   html = html & "  function perdschange() {" & vbCrLf
   ' html = html & "    const space = decodeURIComponent('%20');" & vbCrLf
   html = html & "    const sltprd = document.getElementById('selectPrd').value;" & vbCrLf
   html = html & "    const sltprda = document.getElementById('selectPrda').value;" & vbCrLf
   html = html & "    const sltprd1 = document.getElementById('selectPrd1').value;" & vbCrLf
   html = html & "    const sltprd1a = document.getElementById('selectPrd1a').value;" & vbCrLf
   html = html & "    const currentURL = 'wpgPrtPrintLayoutAll.asp?PrintLayoutName=rptFNHPatientInformation&PositionForTableName=WorkingDay';" & vbCrLf
   html = html & "    const newURL = currentURL + '&WorkingDayID=DAY20160401&selectPrd=' + sltprd + ' ' + getTimeWithSecondsAndMilliseconds(sltprda) + '&selectPrd1=' + sltprd1 + ' ' + getTimeWithSecondsAndMilliseconds(sltprd1a) + '&selectPrddn=Period';" & vbCrLf
   html = html & "    window.location.href = newURL;" & vbCrLf
   html = html & "  }" & vbCrLf
   html = html & "</script>" & vbCrLf
   html = html & " </div>"

   pSelector = html
End Function

Function SplitDateTime(dateTimeStr)
    Dim parts
    parts = Split(dateTimeStr, " ")

    If UBound(parts) = 1 Then
        SplitDateTime = Array(parts(0), parts(1))
    Else
        SplitDateTime = Array(dateTimeStr, "")
    End If
End Function
    

Sub controls(pat, rcpID, dt2, inv)
    If ResquestedForChange(rcpID) Then
        response.write "                  <td class='t-center'><div class='datastat pnd'>Pending Approval</div></td>"
        response.write "                  <td class='t-center'>" & UpadateReceiptStatus(rcpID) & "</td>"
    ElseIf ApprovedChangeRequest(rcpID) Then
        response.write "                  <td class='t-center'><div class='datastat aprv'>Valid</div></td>"
        response.write "                  <td class='t-center'>" & UpadateReceiptStatus(rcpID) & "</td>"
    Else
        response.write "                  <td class='t-center'><div class='datastat dnd'>Invalid</div></td>"
        response.write "                  <td class='t-center'>" & UpadateReceiptStatus(rcpID) & "</td>"
    End If
End Sub

Sub CardVal(pat)
    cardvalue = GetComboNameFld("Patient",pat,"patientinfo1")
    If cardvalue ="printed" Then
        response.write "                  <td class='t-center'>printed</td>"
    else
        response.write "                  <td class='t-center'>not printed</td>"
    End If
End Sub

sub Printcard(pat)
    lnkUrl1 = "wpgPrtPrintLayoutAll.asp?PrintLayoutName=PrintIdCard&PositionForTableName=WorkingDay&WorkingDayID=&patientid=" & pat & "&PrintType=front"
    lnkText = "PrintID [1]"
    response.write "               <div onclick=""openModal('" & lnkUrl1 & "')"" class=' btsty bs bold'>" & lnkText & "</div>"
    
    lnkUrl1 = "wpgPrtPrintLayoutAll.asp?PrintLayoutName=PrintIdCard&PositionForTableName=WorkingDay&WorkingDayID=&patientid=" & pat & "&PrintType=back"
    lnkText = "PrintID [2]"
    response.write "               <div onclick=""openModal('" & lnkUrl1 & "')"" class=' btsty bs bold'>" & lnkText & "</div>"
    'Update PatientInfo For IDCard Printed
    'cardval = GetRecordField("PatientInfo1")
    cardval2 = GetComboNameFld("Patient", pat, "PatientInfo1")
    If cardval2= "Printed" Then
        response.write "               <td class=' btsty bss bold'>Card Printed</td>"
    Else
        response.write "               <td><div onclick=""GetDataFromDb2()"" class=' btsty bwrn bold'>Card Not Printed</div></td>"
    End If
End Sub   

Sub ScpAdded()
    response.write "<script>"
    response.write " const cntTp = document.querySelector('.cnt');"
    response.write " const cntTptg = document.querySelector('.min-top');"
    response.write " const cntTc = document.querySelector('.t-case');"
    response.write " const cntTci = document.querySelector('.t-case-i');"
    response.write " cntTptg.addEventListener('click', () => {"
    response.write "   cntTptg.classList.toggle('act-t');"
    response.write "   if (cntTptg.classList.contains('act-t')) {"
    response.write "     cntTp.classList.add('dn');"
    response.write "     cntTc.classList.add('t-case-m');"
    response.write "     cntTci.textContent = 'Maximize';"
    response.write "   } else {"
    response.write "     cntTp.classList.remove('dn');"
    response.write "     cntTc.classList.remove('t-case-m');"
    response.write "     cntTci.textContent = 'Minimize';"
    response.write "   }"
    response.write " });"
    response.write "</script>"

    response.write " <script>"
    response.write " function openLinkInPopup(url) {"
    response.write "     window.open(url, '_self');"
    response.write "   }"

    response.write " function openPopup(linkUrl, width, height) {"
    response.write " var left = (window.innerWidth - width) / 2;"
    response.write " var top = (window.innerHeight - height) / 2;"
    response.write " window.open(linkUrl, 'PopupWindow', 'width=' + width + ', height=' + height + ', left=' + left + ', top=' + top);"
    response.write " }"
    response.write " </script>"

End Sub

Sub StylesAdded()

    response.write "     <style>"
    response.write "       :root {"
    response.write "         --bc: white;"
    response.write "         --bp: #0994de;"
    response.write "         --br: #ffd54a;"
    response.write "         --brhv: #ffc400;"
    response.write "         --bphv: #087ab8;"
    response.write "         --bss: #05ab5d;"
    response.write "         --bsshv: #198754;"
    response.write "         --bwrn: #ff3f52;"
    response.write "         --bwrnhv: #dc3545;"
    response.write "         --bs: #939393;"
    response.write "         --bshv: #6c757d;"
    response.write "         --bsty-primary: #005f92;"
    response.write "         --bsty-alert: #dc3545;"
    response.write "         --bsty-alert-hover: #ff6776;"
    response.write "         --bsty-primary-hover: #0994de;"
    response.write "         --bsty-success: #198754;"
    response.write "         --bsty-success-hover: #05ab5d;"
    response.write "         --bsty-sec: #ffc400;"
    response.write "         --bsty-sec-hover: #ffd54a;"
    response.write "       }"
    response.write "       .holder {"
    response.write "         display: flex;"
    response.write "       }"
    response.write "       .btsty {"
    response.write "         width: fit-content;"
    response.write "         padding: 4px;"
    response.write "         margin: 0px 0px 0px 5px;"
    response.write "         border-radius: 4px;"
    response.write "         cursor: pointer;"
    response.write "         text-align: center;"
    response.write "         white-space: nowrap;"
    response.write "         border: none;"
    response.write "         font-size: 13.33px;"
    response.write "         text-decoration: none;"
    response.write "       }"
    response.write "       .pm {"
    response.write "         color: var(--bsty-primary);"
    response.write "       }"
    response.write "       .pm:hover {"
    response.write "         text-decoration: underline;"
    response.write "         color: var(--bsty-primary-hover);"
    response.write "       }"
    response.write "       .rd {"
    response.write "         color: var(--bsty-sec);"
    response.write "       }"
    response.write "       .rd:hover {"
    response.write "         text-decoration: underline;"
    response.write "         color: var(--bsty-sec-hover);"
    response.write "       }"
    response.write "       .bnm:hover {"
    response.write "         text-decoration: underline;"
    response.write "       }"
    response.write "       .wrn {"
    response.write "         color: var(--bsty-alert);"
    response.write "       }"
    response.write "       .wrn:hover {"
    response.write "         color: var(--bsty-alert-hover);"
    response.write "         text-decoration: underline;"
    response.write "       }"
    response.write "       .scc {"
    response.write "         color: var(--bsty-success);"
    response.write "       }"
    response.write "       .scc:hover {"
    response.write "         color: var(--bsty-success-hover);"
    response.write "         text-decoration: underline;"
    response.write "       }"
    response.write "       .bp {"
    response.write "         background-color: var(--bp);"
    response.write "         color: var(--bc);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .br {"
    response.write "         background-color: var(--br);"
    response.write "         color: var(--bc);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obp {"
    response.write "         box-shadow: 0px 0px 1px 1px var(--bp);"
    response.write "         color: var(--bphv);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obp:hover {"
    response.write "         background-color: var(--bp);"
    response.write "         color: var(--bc);"
    response.write "       }"
    response.write "       .bp:hover {"
    response.write "         background-color: var(--bphv);"
    response.write "       }"
    response.write "       .bss {"
    response.write "         background-color: var(--bss);"
    response.write "         color: var(--bc);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obss {"
    response.write "         box-shadow: 0px 0px 1px 1px var(--bss);"
    response.write "         color: var(--bsshv);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obss:hover {"
    response.write "         background-color: var(--bss);"
    response.write "         color: var(--bc);"
    response.write "       }"
    response.write "       .bss:hover {"
    response.write "         background-color: var(--bsshv);"
    response.write "       }"
    response.write "       .br:hover {"
    response.write "         background-color: var(--brhv);"
    response.write "       }"
    response.write "       .bwrn {"
    response.write "         background-color: var(--bwrn);"
    response.write "         color: var(--bc);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obwrn {"
    response.write "         box-shadow: 0px 0px 1px 1px var(--bwrn);"
    response.write "         color: var(--bwrnhv);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obwrn:hover {"
    response.write "         background-color: var(--bwrn);"
    response.write "         color: var(--bc);"
    response.write "       }"
    response.write "       .bwrn:hover {"
    response.write "         background-color: var(--bwrnhv);"
    response.write "       }"
    response.write "       .bs {"
    response.write "         background-color: var(--bs);"
    response.write "         color: var(--bc);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obs {"
    response.write "         box-shadow: 0px 0px 1px 1px var(--bs);"
    response.write "         color: var(--bshv);"
    response.write "         margin: 0px 5px 0px 5px;"
    response.write "         padding: 4px 12px;"
    response.write "       }"
    response.write "       .obs:hover {"
    response.write "         background-color: var(--bshv);"
    response.write "         color: var(--bc);"
    response.write "       }"
    response.write "       .bs:hover {"
    response.write "         background-color: var(--bshv);"
    response.write "       }"
    response.write "       .bold {"
    response.write "         font-weight: bold;"
    response.write "       }"
    response.write "       .aln {"
    response.write "         padding: 0px;"
    response.write "         margin: 0px;"
    response.write "       }"
    response.write "       .t-right {"
    response.write "         text-align: right;"
    response.write "       }"
    response.write "       .t-left {"
    response.write "         text-align: left;"
    response.write "       }"
    response.write "       .t-center {"
    response.write "         text-align: center;"
    response.write "       }"
    response.write "       .f-end {"
    response.write "         justify-content: flex-end;"
    response.write "       }"
    response.write "       .table-holder::-webkit-scrollbar {"
    response.write "         width: 5px;"
    response.write "         height: 5px;"
    response.write "       }"
    response.write "       .table-holder::-webkit-scrollbar-track {"
    response.write "         background: #efefef;"
    response.write "       }"
    response.write "       .table-holder::-webkit-scrollbar-thumb {"
    response.write "         background: #b4b4b4;"
    response.write "       }"
    response.write "       .table-holder::-webkit-scrollbar-thumb:hover {"
    response.write "         background: #888;"
    response.write "       }"
    response.write "       .table-holder::-webkit-scrollbar-button:hover {"
    response.write "         background: #888;"
    response.write "       }"
    response.write "       .tbl {"
    response.write "         width: 100%;"
    response.write "         border-collapse: collapse;"
    response.write "       }"
    response.write "       .tbl1 {"
    response.write "         width: 100%;"
    response.write "         border-collapse: collapse;"
    response.write "       }"
    response.write "       .fh {"
    response.write "         padding: 7px 16px;"
    response.write "         font-size: 12px;"
    response.write "         position: sticky;"
    response.write "         top: 0;"
    response.write "         z-index: 9;"
    response.write "         background-color: #f9fafb;"
    response.write "       }"
    response.write "       .tbl-b tr:first-child td {"
    response.write "         border-top: 1px solid #ddd;"
    response.write "       }"
    response.write "       .tbl-b tr:last-child td {"
    response.write "         border-bottom: none;"
    response.write "       }"
    response.write "       .tbl-b tr:last-child td:first-child {"
    response.write "         border-bottom-left-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-b tr:last-child td:last-child {"
    response.write "         border-bottom-right-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-h tr:first-child th:first-child {"
    response.write "         border-top-left-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-h tr:first-child th:last-child {"
    response.write "         border-top-right-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-b tr td {"
    response.write "         padding: 10px 8px;"
    response.write "         border-bottom: 1px solid #ddd;"
    response.write "         background-color: white;"
    response.write "         font-size: 14px;"
    response.write "         vertical-align: top;"
    response.write "       }"
    response.write "       .tbl1 tbody tr td {"
    response.write "         padding: 0px;"
    response.write "         border: none !important;"
    response.write "         background-color: white;"
    response.write "         font-size: 14px;"
    response.write "       }"
    response.write "       .tbl-main {"
    response.write "         border: 1px solid #ddd;"
    response.write "         border-radius: 8px;"
    response.write "       }"
    response.write "       .main-content {"
    response.write "         height: calc(100% - 80px);"
    response.write "         overflow: auto;"
    response.write "         padding-bottom: 20px;"
    response.write "         background-color: #f9fafb;"
    response.write "       }"
    response.write "       .Select-name {"
    response.write "         font-size: 24px;"
    response.write "         font-weight: 600;"
    response.write "       }"
    response.write "       .datastat {"
    response.write "         font-size: 12px;"
    response.write "         width: fit-content;"
    response.write "         padding: 3px 8px;"
    response.write "         border-radius: 8px;"
    response.write "       }"
    response.write "     </style>"
    response.write "     <style>"
    response.write "       * {"
    response.write "         margin: 0;"
    response.write "         padding: 0;"
    response.write "         font-family: 'Segoe UI';"
    response.write "       }"
    response.write "       body {"
    response.write "         background-color: #f9fafb;"
    response.write "       }"
    response.write "       .df {"
    response.write "         display: flex;"
    response.write "         align-items: center;"
    response.write "       }"
    response.write "       .rlt {"
    response.write "         position: relative;"
    response.write "       }"
    response.write "       .abs {"
    response.write "         position: absolute;"
    response.write "       }"
    response.write "       .fs {"
    response.write "         align-items: flex-start;"
    response.write "       }"
    response.write "       .fc {"
    response.write "         flex-direction: column;"
    response.write "       }"
    response.write "       .sb {"
    response.write "         justify-content: space-between;"
    response.write "       }"
    response.write "       .jc {"
    response.write "         justify-content: center;"
    response.write "       }"
    response.write "       .f1 {"
    response.write "         flex: 1;"
    response.write "       }"
    response.write "       .h100 {"
    response.write "         height: 100%;"
    response.write "       }"
    response.write "       .cp {"
    response.write "         cursor: pointer;"
    response.write "       }"
    response.write "       .p10 {"
    response.write "         padding: 10px;"
    response.write "       }"
    response.write "       .plr10 {"
    response.write "         padding-inline: 10px;"
    response.write "       }"
    response.write "       .plr15 {"
    response.write "         padding-inline: 15px;"
    response.write "       }"
    response.write "       .plr25 {"
    response.write "         padding-inline: 25px;"
    response.write "       }"
    response.write "       .p15 {"
    response.write "         padding: 15px;"
    response.write "       }"
    response.write "       .p25 {"
    response.write "         padding: 25px;"
    response.write "       }"
    response.write "       .pb10 {"
    response.write "         padding-bottom: 10px;"
    response.write "       }"
    response.write "       .pb15 {"
    response.write "         padding-bottom: 15px;"
    response.write "       }"
    response.write "       .pb25 {"
    response.write "         padding-bottom: 25px;"
    response.write "       }"
    response.write "       .pt10 {"
    response.write "         padding-top: 10px;"
    response.write "       }"
    response.write "       .pt15 {"
    response.write "         padding-top: 15px;"
    response.write "       }"
    response.write "       .pt25 {"
    response.write "         padding-top: 25px;"
    response.write "       }"
    response.write "       .m10 {"
    response.write "         margin: 10px;"
    response.write "       }"
    response.write "       .mlr10 {"
    response.write "         margin-inline: 10px;"
    response.write "       }"
    response.write "       .mlr15 {"
    response.write "         margin-inline: 15px;"
    response.write "       }"
    response.write "       .mlr25 {"
    response.write "         margin-inline: 25px;"
    response.write "       }"
    response.write "       .m15 {"
    response.write "         margin: 15px;"
    response.write "       }"
    response.write "       .m25 {"
    response.write "         margin: 25px;"
    response.write "       }"
    response.write "       .w100 {"
    response.write "         width: 100%;"
    response.write "       }"
    response.write "       .t1 {"
    response.write "         font-size: 18px;"
    response.write "         font-weight: 600;"
    response.write "       }"
    response.write "       .st1 {"
    response.write "         font-size: 16px;"
    response.write "       }"
    response.write "       .sblg {"
    response.write "         width: 185px;"
    response.write "       }"
    response.write "       .st1s {"
    response.write "         font-size: 15px;"
    response.write "         color: #a1a0a0;"
    response.write "       }"
    response.write "       .t2 {"
    response.write "         font-size: 16px;"
    response.write "         font-weight: 500;"
    response.write "       }"
    response.write "       .t3 {"
    response.write "         font-size: 16px;"
    response.write "         font-weight: 400;"
    response.write "       }"
    response.write "       .st2 {"
    response.write "         font-size: 14px;"
    response.write "       }"
    response.write "       .st3 {"
    response.write "         font-size: 14px;"
    response.write "         font-weight: 300;"
    response.write "       }"
    response.write "       .st2s {"
    response.write "         font-size: 13px;"
    response.write "         color: #a1a0a0;"
    response.write "       }"
    response.write "       .st3s {"
    response.write "         font-size: 13px;"
    response.write "         color: #a1a0a0;"
    response.write "         font-weight: 300;"
    response.write "       }"
    response.write "       .aprv {"
    response.write "         background-color: #def7ec;"
    response.write "         font-weight: 600;"
    response.write "         color: #046c4e;"
    response.write "       }"
    response.write "       .dnd {"
    response.write "         background-color: #fde8e8;"
    response.write "         font-weight: 600;"
    response.write "         color: #c01e1e;"
    response.write "       }"
    response.write "       .pnd {"
    response.write "         background-color: #feecdc;"
    response.write "         font-weight: 600;"
    response.write "         color: #b43403;"
    response.write "       }"
    response.write "       .expd {"
    response.write "         background-color: #f4f5f7;"
    response.write "         font-weight: 600;"
    response.write "         color: #24262d;"
    response.write "       }"
    response.write "       .icn {"
    response.write "         width: 45px;"
    response.write "         height: 45px;"
    response.write "         border-radius: 50%;"
    response.write "         font-size: 20px;"
    response.write "       }"
    response.write "       .top-dt {"
    response.write "         border: 1px solid #ddd;"
    response.write "         border-radius: 8px;"
    response.write "         background-color: white;"
    response.write "       }"
    response.write "       .tbl-b1 tr:first-child td {"
    response.write "         border-top: 1px solid #ddd;"
    response.write "       }"
    response.write "       .tbl-b1 tr:last-child td {"
    response.write "         border-bottom: none;"
    response.write "       }"
    response.write "       .tbl-b1 tr:last-child td:first-child {"
    response.write "         border-bottom-left-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-b1 tr:last-child td:last-child {"
    response.write "         border-bottom-right-radius: 8px;"
    response.write "       }"
    response.write "       .tbl-b1 tr td {"
    response.write "         padding: 12px 16px;"
    response.write "         border-bottom: 1px solid #ddd;"
    response.write "         background-color: white;"
    response.write "         font-size: 14px;"
    response.write "       }"
    response.write "       .pt0 {"
    response.write "         padding-top: 0px !important;"
    response.write "       }"
    response.write "       .mt0 {"
    response.write "         margin-top: 0px !important;"
    response.write "       }"
    response.write "       .pr0 {"
    response.write "         padding-right: 0px !important;"
    response.write "       }"
    response.write "       .wn {"
    response.write "         white-space: nowrap;"
    response.write "       }"
    response.write "       .pl0 {"
    response.write "         padding-left: 0px !important;"
    response.write "       }"
    response.write "       .pl10 {"
    response.write "         padding-left: 10px;"
    response.write "       }"
    response.write "       .pb0 {"
    response.write "         padding-bottom: 0px !important;"
    response.write "       }"
    response.write "       td .p5 {"
    response.write "         padding: 5px !important;"
    response.write "       }"
    response.write "       .fh1 {"
    response.write "         padding: 5px 10px;"
    response.write "         font-size: 12px;"
    response.write "         background-color: #f9fafb;"
    response.write "       }"
    response.write "       .dn {"
    response.write "         display: none !important;"
    response.write "         border: none !important;"
    response.write "       }"
    response.write "       .meal-tbl tr td {"
    response.write "         padding: 2px;"
    response.write "       }"
    response.write "       .meal-hld {"
    response.write "         flex-grow: 1;"
    response.write "       }"
    response.write "       .meal-hld:first-child {"
    response.write "         background-color: #fff6b689;"
    response.write "       }"
    response.write "       .meal-hld:nth-child(2) {"
    response.write "         background-color: #ffdcb686;"
    response.write "       }"
    response.write "       .meal-hld:last-child {"
    response.write "         background-color: #ffc6b689;"
    response.write "       }"
    response.write "       .meal-hld:first-child {"
    response.write "         border-bottom-left-radius: 8px;"
    response.write "         border-top-left-radius: 8px;"
    response.write "       }"
    response.write "       .meal-hld:last-child {"
    response.write "         border-bottom-right-radius: 8px;"
    response.write "         border-top-right-radius: 8px;"
    response.write "       }"
    response.write "       .menu {"
    response.write "         background-color: white;"
    response.write "         align-items: stretch;"
    response.write "         width: fit-content;"
    response.write "         border-radius: 8px;"
    response.write "         box-shadow: 0px 0px 3px 1px #ddd;"
    response.write "       }"
    response.write "       .opt-sty {"
    response.write "         font-size: 12px;"
    response.write "         background: #eeeeee;"
    response.write "       }"
    response.write " .select-value1 {"
    response.write "   padding-inline: 8px;"
    response.write "   padding-top: 4px;"
    response.write "   padding-bottom: 4px;"
    response.write "   font-size: 12px !important;"
    ' response.Write "   display: block;"
    response.write "   box-sizing: border-box;"
    response.write "   border-radius: 4px;"
    response.write "   border: 1px solid #dddddd;"
    response.write "   outline: none;"
    response.write "   background: #f8f8f8;"
    response.write "   transition: background 0.2s, border-color 0.2s;"
    ' response.Write "   max-width: 16%;"
    response.write "   min-width: 16%;"
    response.write "   text-align: left;"
    response.write " }"
    response.write " .select-value1:focus {"
    response.write "   border-color: #a8d9e4;"
    response.write "   background: #ffffff;"
    response.write " }"
    response.write "  .pt0 {"
    response.write "    padding-top: 0px !important;"
    response.write "  }"
    response.write "  .pr0 {"
    response.write "    padding-right: 0px !important;"
    response.write "  }"
    response.write "  .pl0 {"
    response.write "    padding-left: 0px !important;"
    response.write "  }"
    response.write "  .pb0 {"
    response.write "    padding-bottom: 0px !important;"
    response.write "  }"
    response.write "  td .p5 {"
    response.write "    padding: 5px !important;"
    response.write "  }"
    response.write "  .fh1 {"
    response.write "    padding: 5px 10px;"
    response.write "    font-size: 12px;"
    response.write "    background-color: #f9fafb;"
    response.write "  }"
    response.write "  .dn {"
    response.write "    display: none !important;"
    response.write "    border: none !important;"
    response.write "  }"
    response.write " .custom-tooltip {"
    response.write "   position: relative;"
    response.write "   display: inline-block;"
    response.write "   cursor: pointer;"
    response.write " }"
    response.write " .tooltip-text {"
    response.write "   display: none;"
    response.write "   position: absolute;"
    response.write "   left: 10px;"
    response.write "   background-color: #afafaf;"
    response.write "   color: #fff;"
    response.write "   padding: 5px;"
    response.write "   border-radius: 6px;"
    response.write " }"
    response.write " .p24 {"
    response.write "   padding: 2px 4px;"
    response.write " }"
    response.write "       .tbl-b tr:hover td {"
    response.write "         background-color: #fafafa;"
    response.write "       }"
    ' response.Write "        th[data-sort='asc']::after {"
    ' response.Write "           content: ' ?';"
    ' response.Write "           font-size: 12px;"
    ' response.Write "           line-height: 1;"
    ' response.Write "         }"
    ' response.Write "         th[data-sort='desc']::after {"
    ' response.Write "           content: ' ?';"
    ' response.Write "           font-size: 12px;"
    ' response.Write "           line-height: 1;"
    ' response.Write "         }"
    response.write " .hld-abs {"
    response.write "    bottom: 20px;"
    response.write "    z-index: 999;"
    response.write "    display: none;"
    response.write "  }"
    response.write "  .prc-hld {"
    response.write "    background-color: #f9fafb;"
    response.write "    border-radius: 12px;"
    response.write "    box-shadow: 1px 1px 15px 0px #dfdfdf;"
    response.write "  }"
    response.write "  .tbls tr td {"
    response.write "    border: none !important;"
    response.write "    background: none !important;"
    response.write "  }"
    response.write "  .rlt-act:hover .hld-abs {"
    response.write "    display: block;"
    response.write "  }"
    response.write "         @media print {"
    response.write "           .dnp {"
    response.write "             display: none !important;"
    response.write "           }"
    response.write "         }"
    response.write "    .min-top {"
    response.write "      right: 20px;"
    response.write "      top: 0;"
    response.write "      visibility: hidden;"
    response.write "      opacity: 0;"
    response.write "      width: 30px;"
    response.write "      height: 30px;"
    response.write "      background: #ededed;"
    response.write "      border-radius: 50%;"
    response.write "      color: #959494;"
    response.write "      transition: all 0.7s ease;"
    response.write "    }"
    response.write "    .t-case:hover .min-top,"
    response.write "    .min-top:hover .t-case-i {"
    response.write "      visibility: visible;"
    response.write "      opacity: 1;"
    response.write "    }"
    response.write "    .icnn {"
    response.write "      transition: all 0.5s ease;"
    response.write "    }"
    response.write "    .t-case-i {"
    response.write "      top: -11px;"
    response.write "      right: 13px;"
    response.write "      background: #efefef;"
    response.write "      padding: 2px 4px;"
    response.write "      border-radius: 5px;"
    response.write "      color: #595959;"
    response.write "      font-size: 13px;"
    response.write "      visibility: hidden;"
    response.write "      opacity: 0;"
    response.write "      transition: all 1s ease;"
    response.write "    }"
    response.write "    .min-top:hover {"
    response.write "      background: #d1d1d1;"
    response.write "      color: #474747;"
    response.write "    }"
    response.write "    .act-t {"
    response.write "      visibility: visible;"
    response.write "      opacity: 1;"
    response.write "    }"
    response.write "    .act-t > .fa-angle-up {"
    response.write "      rotate: 180deg;"
    response.write "    }"
    response.write "    .t-case-m {"
    response.write "      padding-top: 0;"
    response.write "      padding-bottom: 2px;"
    response.write "    }"
    response.write "    .dn {"
    response.write "      max-width: 0;"
    response.write "      overflow: hidden;"
    response.write "      display: none;"
    response.write "    }"
    response.write "    .mw-115 {"
    response.write "      min-width: 115px;"
    response.write "    }"
    response.write "    .mw-300 {"
    response.write "      min-width: 300px;"
    response.write "    }"
    response.write "     </style>"
    
End Sub

Sub TableEXScp()

    response.write " <script>"
    response.write "   const prevButton = document.getElementById('prevPage');"
    response.write "   const nextButton = document.getElementById('nextPage');"
    response.write "   const currentPageDisplay = document.getElementById('currentPage');"
    response.write "   const table = document.querySelector('.tbl');"
    response.write "   const rows = Array.from(table.querySelectorAll('tbody tr'));"
    response.write "   const searchInput = document.getElementById('searchInput');"
    response.write "   const printButton = document.getElementById('printButton');"
    response.write "   const rowsPerPage = 10;"
    response.write "   const tbody = table.querySelector('tbody');"
    response.write "   const ths = Array.from(table.querySelectorAll('th'));"
    response.write "   let currentPage = 1;"
    ' response.write "   function displayRows() {"
    ' response.write "     const startIndex = (currentPage - 1) * rowsPerPage;"
    ' response.write "     const endIndex = startIndex + rowsPerPage;"
    ' response.write "     rows.forEach((row, index) => {"
    ' response.write "       if (index >= startIndex && index < endIndex) {"
    ' response.write "         row.style.display = 'table-row';"
    ' response.write "       } else {"
    ' response.write "         row.style.display = 'none';"
    ' response.write "       }"
    ' response.write "     });"
    ' response.write "   }"
    ' response.write "   displayRows();"
    ' response.write "   prevButton.addEventListener('click', () => {"
    ' response.write "     if (currentPage > 1) {"
    ' response.write "       currentPage--;"
    ' response.write "       currentPageDisplay.textContent = currentPage;"
    ' response.write "       displayRows();"
    ' response.write "     }"
    ' response.write "   });"
    ' response.write "   nextButton.addEventListener('click', () => {"
    ' response.write "     if (currentPage < Math.ceil(rows.length / rowsPerPage)) {"
    ' response.write "       currentPage++;"
    ' response.write "       currentPageDisplay.textContent = currentPage;"
    ' response.write "       displayRows();"
    ' response.write "     }"
    ' response.write "   });"
    response.write "   function filterRows() {"
    response.write "     const query = searchInput.value.toLowerCase();"
    response.write "     rows.forEach((row) => {"
    response.write "       const text = row.innerText.toLowerCase();"
    response.write "       if (text.includes(query)) {"
    response.write "         row.style.display = 'table-row';"
    response.write "       } else {"
    response.write "         row.style.display = 'none';"
    response.write "       }"
    response.write "     });"
    response.write "   }"
    response.write "   searchInput.addEventListener('input', filterRows);"
    response.write "   function getDataType(columnIndex) {"
    response.write "     const rows = Array.from(tbody.querySelectorAll('tr'));"
    response.write "     for (const row of rows) {"
    response.write "       const cellValue = row.querySelector("
    response.write "         `td:nth-child(${columnIndex + 1})`"
    response.write "       ).textContent;"
    response.write "       if (!isNaN(parseFloat(cellValue))) {"
    response.write "         return 'number';"
    response.write "       }"
    response.write "     }"
    response.write "     return 'string';"
    response.write "   }"
    response.write "   function sortTable(columnIndex) {"
    response.write "     if (ths[columnIndex].classList.contains('nosort')) {"
    response.write "       return;"
    response.write "     }"
    response.write "     const dataType = getDataType(columnIndex);"
    response.write "     const isAscending ="
    response.write "       ths[columnIndex].getAttribute('data-sort') === 'asc';"
    response.write "     const rows = Array.from(tbody.querySelectorAll('tr'));"
    response.write "     rows.sort((a, b) => {"
    response.write "       const cellA = a.querySelector("
    response.write "         'td:nth-child(' + (columnIndex + 1) + ')'"
    response.write "       ).textContent;"
    response.write "       const cellB = b.querySelector("
    response.write "         'td:nth-child(' + (columnIndex + 1) + ')'"
    response.write "       ).textContent;"
    response.write "       if (dataType === 'number') {"
    response.write "         return isAscending"
    response.write "           ? parseFloat(cellA) - parseFloat(cellB)"
    response.write "           : parseFloat(cellB) - parseFloat(cellA);"
    response.write "       } else {"
    response.write "         return isAscending"
    response.write "           ? cellA.localeCompare(cellB)"
    response.write "           : cellB.localeCompare(cellA);"
    response.write "       }"
    response.write "     });"
    response.write "     rows.forEach((row) => tbody.appendChild(row));"
    response.write "     ths.forEach((th) => th.setAttribute('data-sort', 'none'));"
    response.write "     ths[columnIndex].setAttribute("
    response.write "       'data-sort',"
    response.write "       isAscending ? 'desc' : 'asc'"
    response.write "     );"
    response.write "   }"
    response.write "   ths.forEach((th, index) => {"
    response.write "     th.addEventListener('click', () => {"
    response.write "       sortTable(index);"
    response.write "     });"
    response.write "   });"
    response.write "   function exportTableToExcel() {"
    response.write "     const table = document.querySelector('table');"
    response.write "     const rows = Array.from(table.querySelectorAll('tr'));"
    response.write "     let excelContent = '<table>';"
    response.write "     rows.forEach((row) => {"
    response.write "       const cells = Array.from(row.querySelectorAll('td, th')); "
    response.write "       excelContent += '<tr>';"
    response.write "       cells.forEach((cell, index) => {"
    response.write "         if ("
    response.write "           !table"
    response.write "             .querySelector(`th:nth-child(${index + 1}`)"
    response.write "             .classList.contains('ignore')"
    response.write "         ) {"
    response.write "           excelContent += `<td>${cell.textContent}</td>`;"
    response.write "         }"
    response.write "       });"
    response.write "       excelContent += '</tr>';"
    response.write "     });"
    response.write "     excelContent += '</table>';"
    response.write "     const excelBlob = new Blob([excelContent], {"
    response.write "       type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',"
    response.write "     });"
    response.write "     const link = document.createElement('a');"
    response.write "     link.href = URL.createObjectURL(excelBlob);"
    response.write "     link.setAttribute('download', 'table_data.xls');"
    response.write "     link.click();"
    response.write "   }"
    response.write "   function exportTableToCSV() {"
    response.write "     const table = document.querySelector('table');"
    response.write "     const rows = Array.from(table.querySelectorAll('tr'));"
    response.write "     let csvContent = '';"
    response.write "     rows.forEach((row) => {"
    response.write "       const cells = Array.from(row.querySelectorAll('td, th')); "
    response.write "       csvContent += cells.map((cell) => `'${cell.textContent}'`).join(',');"
    response.write "       csvContent += '\n';"
    response.write "     });"
    response.write "     const csvBlob = new Blob([csvContent], {"
    response.write "       type: 'text/csv;charset=utf-8;',"
    response.write "     });"
    response.write "     const link = document.createElement('a');"
    response.write "     link.href = URL.createObjectURL(csvBlob);"
    response.write "     link.setAttribute('download', 'table_data.csv');"
    response.write "     link.click();"
    response.write "   }"
    response.write "   const exportExcelButton = document.getElementById('exportExcel');"
    response.write "   exportExcelButton.addEventListener('click', exportTableToExcel);"
    response.write "   const exportCSVButton = document.getElementById('exportCSV');"
    response.write "   exportCSVButton.addEventListener('click', exportTableToCSV);"
    response.write "   function printTable() {"
    response.write "     window.print();"
    response.write "   }"
    response.write "   printButton.addEventListener('click', printTable);"
    response.write "       function GetDataFromDb2() {"
    response.write "         var getStr = 'ProcedureName=ProcessUPdate&PatientID=" & GetRecordField("PatientID") & "';"
    response.write "         let xhr = new XMLHttpRequest();"
    response.write "         var url = 'wpgXmlHttp.asp?' + getStr;"
    response.write "         xhr.open('GET', url);"
    response.write "         xhr.send();"
    response.write "         location.replace('wpgPrtPrintLayoutAll.asp?PrintLayoutName=PatientRCP&PositionForTableName=Patient&PatientID=" & GetRecordField("PatientID") & "');"
    response.write "       }"
      
    
    response.write " </script>"

End Sub

Function periodSelector(periodID, periodType, periodgroupID, periodgroupType, table)
    Dim rst, sql
    Set rst = CreateObject("ADODB.Recordset")
    html = " "

    sql = " Select DISTINCT " & periodID & ", " & periodgroupID & " FROM " & table
    sql = sql & " ORDER BY " & periodID & " DESC;"

    html = html & " <div class='period-selector df f1'> "
    html = html & "     <span class='plr10 t2'>Select Registration Month</span>"
    html = html & "     <Select class='select-value1' name='Selector' id='prdSelector' onchange=""periodOnchange('prdSelector')"">"
    html = html & "         <option value=''></option>"
    If (UCase(wrkMth) = "AllMonths") Then
        html = html & "         <option class='opt-sty' value='AllMonths' id='AllMonths' selected>All</option>"
    Else
        html = html & "         <option class='opt-sty' value='AllMonths' id='AllMonths'>All</option>"
    End If

    cMth = ""
    rst.open qryPro.FltQry(sql), conn, 3, 4
    If rst.RecordCount > 0 Then
        rst.movefirst
        Do Until rst.EOF
            groupName = GetComboName("" & periodgroupType & "", rst.fields("" & periodgroupID & ""))
            val = rst.fields("" & periodID & "")
            valName = GetComboName("" & periodType & "", rst.fields("" & periodID & ""))

            If (cMth <> groupName) Then
                html = html & "         <optgroup Label='" & groupName & "'>"
                cMth = groupName
            End If
            If UCase(CStr(val)) = UCase(wrkMth) Then
                html = html & "         <option class='opt-sty' value='" & CStr(val) & "' id='" & CStr(val) & "' selected >" & valName & "</option>"
            Else
                html = html & "         <option class='opt-sty' value='" & CStr(val) & "' id='" & CStr(val) & "'>" & valName & "</option>"
            End If

            rst.movenext
        Loop
    End If

    html = html & "     </Select>"
    html = html & " <script>" & vbCrLf
    html = html & "  function periodOnchange(selectId) {" & vbCrLf
    html = html & "    const selectElement = document.getElementById(selectId);" & vbCrLf
    html = html & "    const selectedOption = selectElement.options[selectElement.selectedIndex];" & vbCrLf
    html = html & "    const selectedValue = selectedOption.value;" & vbCrLf
    html = html & "    const currentURL = 'wpgPrtPrintLayoutAll.asp?PrintLayoutName=rptFNHPatientInformation&PositionForTableName=WorkingDay';" & vbCrLf
    html = html & "    const newURL = currentURL + '&WorkingDayID=DAY20160401&wrkMth=' + selectedValue;" & vbCrLf
    ' html = html & "    window.location.href = processurl(newURL);" & vbCrLf
    html = html & "    window.location.href = newURL;" & vbCrLf
    html = html & "  }" & vbCrLf
    html = html & "</script>" & vbCrLf
    html = html & " </div>"

    rst.Close
    Set rst = Nothing
    periodSelector = html
End Function
    
'<<--END_CODE_SEGMENT_PRINTHEADER-->>
'>
'>
'>
'>
'>
'<<--BEGIN_CODE_SEGMENT_PRINTFOOTER-->>

'<<--END_CODE_SEGMENT_PRINTFOOTER-->>
